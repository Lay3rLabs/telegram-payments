version: "3"

includes:
  config:
    taskfile: ./config.yml
    flatten: true

tasks:
  contract-off-chain:
    requires:
      vars: [CONTRACT]
    vars:
      CONTRACT_SRC_NAME:
        sh: task contracts:src-name CONTRACT_KIND={{.CONTRACT}}
    cmds:
      - echo "Testing {{.CONTRACT}} off-chain"
      - cd packages/tests/off-chain && cargo test --test {{.CONTRACT_SRC_NAME}}

  off-chain:
    cmds:
      - echo "Testing off-chain"
      - cd packages/tests/off-chain && cargo test
